import{r as f,g as y,j as B,k as M,l as N,c as n,o as s,m as a,a as t,n as h,t as d,F as C,p as q,q as L,s as E,_ as D,b as w,w as R,d as S,v as V}from"./BXfW8s_0.js";import{_ as F}from"./1iIW29d6.js";const T=window.setInterval,H={class:"hero-carousel"},j={key:0,class:"loading"},z={key:1,class:"error"},O={key:2,class:"carousel-container"},P={class:"carousel-slide"},U=["src","alt"],G={class:"hero-content"},J={class:"anime-meta"},K={class:"anime-year"},Q={class:"anime-episodes"},W={class:"hero-title"},X={class:"hero-subtitle"},Y={class:"carousel-dots"},Z=["onClick","aria-label"],ee={class:"carousel-thumbnails"},te=["onClick"],ae=["src","alt"],se={class:"thumbnail-overlay"},ne={class:"thumbnail-title"},ie={__name:"HeroBanner",setup(l){const e=E(),i=f([]),c=f(0),m=f(!0),r=y(()=>i.value[c.value]),_=async()=>{try{const{data:o}=await $fetch(`${e.public.apiBase}/api/animes?limit=5&recent=true`);o&&o.length>0&&(i.value=o)}catch(o){console.error("Error fetching recent animes:",o)}finally{m.value=!1}},u=()=>{c.value=(c.value+1)%i.value.length},x=()=>{c.value=(c.value-1+i.value.length)%i.value.length},$=o=>{c.value=o},k=o=>o?o.length>200?o.substring(0,200)+"...":o:"Découvrez cet anime passionnant",A=o=>{o.target.style.display="none"};let p=null;return B(async()=>{await _(),i.value.length>0&&(p=T(()=>{u()},5e3))}),M(()=>{p&&clearInterval(p)}),N(()=>i.value.length,o=>{o>0&&!p&&(p=T(()=>{u()},5e3))}),(o,b)=>(s(),n("div",H,[a(m)?(s(),n("div",j," Chargement des animes récents... ")):a(i).length===0?(s(),n("div",z," Aucun anime trouvé ")):(s(),n("div",O,[t("div",P,[a(r).image?(s(),n("img",{key:0,src:`/images/${a(r).image}`,alt:a(r).titre,class:"hero-image",onError:A},null,40,U)):h("",!0),b[1]||(b[1]=t("div",{class:"hero-overlay"},null,-1)),t("div",G,[t("div",J,[t("span",K,d(a(r).annee),1),t("span",Q,d(a(r).nb_ep)+" épisodes",1)]),t("h1",W,d(a(r).titre),1),t("p",X,d(k(a(r).synopsis)),1),b[0]||(b[0]=t("div",{class:"hero-actions"},[t("button",{class:"hero-button primary"}," Découvrir "),t("button",{class:"hero-button secondary"}," Voir la fiche ")],-1))])]),t("button",{class:"carousel-nav prev",onClick:x,"aria-label":"Anime précédent"}," ‹ "),t("button",{class:"carousel-nav next",onClick:u,"aria-label":"Anime suivant"}," › "),t("div",Y,[(s(!0),n(C,null,q(a(i),(v,g)=>(s(),n("button",{key:g,class:L(["dot",{active:g===a(c)}]),onClick:I=>$(g),"aria-label":`Aller à l'anime ${g+1}`},null,10,Z))),128))]),t("div",ee,[(s(!0),n(C,null,q(a(i),(v,g)=>(s(),n("div",{key:v.id_anime,class:L(["thumbnail",{active:g===a(c)}]),onClick:I=>$(g)},[v.image?(s(),n("img",{key:0,src:`/images/${v.image}`,alt:v.titre,onError:A},null,40,ae)):h("",!0),t("div",se,[t("span",ne,d(v.titre),1)])],10,te))),128))])]))]))}},re=["innerHTML"],ce={__name:"FormattedText",props:{text:{type:String,default:""},className:{type:String,default:""},maxLength:{type:Number,default:null},showReadMore:{type:Boolean,default:!1}},setup(l){const e=l,i=f(!1),c=y(()=>{if(!e.maxLength||e.text.length<=e.maxLength)return e.text;const u=e.text.lastIndexOf(" ",e.maxLength);return e.text.substring(0,u>0?u:e.maxLength)+"..."}),m=y(()=>e.maxLength&&e.text.length>e.maxLength),r=y(()=>e.showReadMore&&m.value&&!i.value?c.value:e.text),_=()=>{i.value=!i.value};return(u,x)=>l.text?(s(),n("div",{key:0,class:L(["formatted-text",l.className])},[t("div",{class:"critique-content",innerHTML:a(r)},null,8,re),l.showReadMore&&a(m)?(s(),n("button",{key:0,onClick:_,class:"read-more-btn",type:"button"},d(a(i)?"Lire moins":"Lire plus"),1)):h("",!0)],2)):h("",!0)}},oe=D(ce,[["__scopeId","data-v-804fffef"]]),le={class:"article-card"},ue=["src","alt"],de={class:"article-content"},_e={class:"article-meta"},me={class:"article-type"},he={key:0,class:"article-rating"},ge={class:"article-title"},ve={key:0,class:"article-excerpt"},fe={class:"article-footer"},pe={class:"article-date"},ye={key:0,class:"article-author"},xe={__name:"ArticleCard",props:{article:{type:Object,required:!0}},setup(l){const e=l,i=r=>r?new Date(r).toLocaleDateString("fr-FR"):"",c=y(()=>e.article.id_anime&&e.article.id_anime!==0?{image:e.article.anime_image,title:e.article.anime_titre||"Anime",type:"Anime"}:e.article.id_manga&&e.article.id_manga!==0?{image:e.article.manga_image,title:e.article.manga_titre||"Manga",type:"Manga"}:{image:null,title:e.article.titre||"Critique",type:"Critique"}),m=r=>{r.target.style.display="none"};return(r,_)=>{const u=oe;return s(),n("div",le,[a(c).image?(s(),n("img",{key:0,src:`/images/${a(c).image}`,alt:a(c).title,class:"article-image",onError:m},null,40,ue)):h("",!0),t("div",de,[t("div",_e,[t("span",me,d(a(c).type),1),l.article.notation?(s(),n("span",he," ★ "+d(l.article.notation)+"/10 ",1)):h("",!0)]),t("h3",ge,d(a(c).title),1),l.article.critique?(s(),n("div",ve,[w(u,{text:l.article.critique,"max-length":150,"show-read-more":!0,class:"text-sm text-gray-600"},null,8,["text"])])):h("",!0),t("div",fe,[t("p",pe,d(i(l.article.date_critique||l.article.date_ajout)),1),l.article.username?(s(),n("p",ye," Par "+d(l.article.username),1)):h("",!0)])])])}}},$e={class:"main-content"},ke={class:"section"},be={class:"section-header"},Ce={key:0,class:"loading"},qe={key:1,class:"articles-grid"},Ae={__name:"index",setup(l){const e=E(),i=f([]),c=f(!0),m=async()=>{try{const{data:r}=await $fetch(`${e.public.apiBase}/api/critiques?limit=3`);i.value=r||[]}catch(r){console.error("Error fetching critiques:",r)}finally{c.value=!1}};return B(()=>{m()}),(r,_)=>{const u=ie,x=F,$=xe;return s(),n("div",$e,[w(u),t("section",ke,[t("div",be,[_[1]||(_[1]=t("h2",{class:"section-title"},"Dernières critiques",-1)),w(x,{to:"/critiques",class:"section-link"},{default:R(()=>_[0]||(_[0]=[S(" Voir toutes les critiques → ")])),_:1,__:[0]})]),a(c)?(s(),n("div",Ce," Chargement des articles... ")):(s(),n("div",qe,[(s(!0),n(C,null,q(a(i),k=>(s(),V($,{key:k.id_critique,article:k},null,8,["article"]))),128))]))])])}}};export{Ae as default};
